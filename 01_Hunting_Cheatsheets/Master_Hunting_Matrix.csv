Platform,MITRE ATT&CK Tactics, MITRE ATT&CK Technique, Tool / Binary, Host/Network Artifacts, Data Source, Logic, SQL (Splunk), KQL Query, Common False Positives
Windows,Command and Control, T1105 - Ingress Tool Transfer, certutil,"certutil command with ""-urlcache"" and ""-f"" flags", Sysmon Event 1, LoLBin Abuse: Misusing the -urlcache flag to download arbitrary files (Ingress Tool Transfer) or -decode to obfuscate payloads. Bypasses application whitelisting.,"EventCode=""1"" Image=""*\\certutil.exe"" CommandLine=""*-urlcache* -f *""",, Legitimate use of certutil for certificate management.
Windows,Command and Control, T1105 - Ingress Tool Transfer, certutil,"certutil command with ""-urlcache"" and ""-f"" flags",Security Event 4688, LoLBin Abuse: Misusing the -urlcache flag to download arbitrary files (Ingress Tool Transfer) or -decode to obfuscate payloads. Bypasses application whitelisting.,,, Legitimate use of certutil for certificate management.
Windows,Command and Control, T1105 - Ingress Tool Transfer,PowerShell (Invoke-WebRequest),"powershell.exe command contains Invoke-WebRequest, iwr, wget, curl",Sysmon Event 1,Download Cradle: Fetches remote payloads using aliases. Sysmon 1 captures full arguments,"EventCode=""1"" Image=""*\\powershell.exe"" CommandLine IN (""*Invoke-WebRequest*"", ""*iwr*"", ""*wget*"", ""*curl*"")",,DevOps scripts; Chocolatey installer.
Windows,Command and Control, T1105 - Ingress Tool Transfer,PowerShell (Invoke-WebRequest),"powershell.exe command contains Invoke-WebRequest, iwr, wget, curl",Security Event 4688,,,,DevOps scripts; Chocolatey installer.
Windows,Command and Control, T1105 - Ingress Tool Transfer,PowerShell (Invoke-WebRequest),"powershell.exe command contains Invoke-WebRequest, iwr, wget, curl",PowerShell Event 4104,Download Cradle: Fetches remote payloads using aliases. Powershell 4104 captures full script block,"EventCode=4104 ScriptBlockText IN (¡°*Invoke-WebRequest*¡±, ""*iwr*"", *""wget*"", ""*curl*"")",,DevOps scripts; Chocolatey installer.
Windows,Command and Control, T1105 - Ingress Tool Transfer,curl.exe (Native Binary),"Image is curl.exe; Args: -O, -o",Sysmon Event 1,Native Binary Abuse: Distinct from PowerShell alias. Used to bypass PS logging constraints,"EventCode=""1"" Image=""*\\curl.exe"" AND CommadnLine=""*http*"" AND CommandLine IN (""*-O*"" OR ""-o"")",,DevOps scripts; Developer workstations.
Windows,Command and Control, T1105 - Ingress Tool Transfer,curl.exe (Native Binary),"Image is curl.exe; Args: -O, -o",Security Event 4688,Native Binary Abuse: Distinct from PowerShell alias. Used to bypass PS logging constraints,,,DevOps scripts; Developer workstations.