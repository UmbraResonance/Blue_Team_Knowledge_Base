Platform,MITRE ATT&CK Tactics, MITRE ATT&CK Technique, Tool / Binary, Host/Network Artifacts, Data Source, Logic, SPL (Splunk), Microsoft KQL Query,Elastic KQL Query, Common False Positives
Windows,Command and Control, T1105 - Ingress Tool Transfer, certutil,"certutil command with ""-urlcache"" and ""-f"" flags", Sysmon Event 1, LoLBin Abuse: Misusing the -urlcache flag to download arbitrary files (Ingress Tool Transfer) or -decode to obfuscate payloads. Bypasses application whitelisting.,"EventCode=""1"" Image=""*\\certutil.exe"" CommandLine=""*-urlcache* -f *""",,, Legitimate use of certutil for certificate management.
Windows,Command and Control, T1105 - Ingress Tool Transfer, certutil,"certutil command with ""-urlcache"" and ""-f"" flags",Security Event 4688, LoLBin Abuse: Misusing the -urlcache flag to download arbitrary files (Ingress Tool Transfer) or -decode to obfuscate payloads. Bypasses application whitelisting.,"EventCode=4688 NewProcessName=""*\\certutil.exe"" (CommandLine=""*-urlcache*"" OR CommandLine=""*-f*"")",,, Legitimate use of certutil for certificate management.
Windows,Command and Control, T1105 - Ingress Tool Transfer,PowerShell (Invoke-WebRequest),"powershell.exe command contains Invoke-WebRequest, iwr, wget, curl",Sysmon Event 1,Download Cradle: Fetches remote payloads using aliases. Sysmon 1 captures full arguments,"EventCode=""1"" Image=""*\\powershell.exe"" CommandLine IN (""*Invoke-WebRequest*"", ""*iwr*"", ""*wget*"", ""*curl*"")",,,DevOps scripts; Chocolatey installer.
Windows,Command and Control, T1105 - Ingress Tool Transfer,PowerShell (Invoke-WebRequest),"powershell.exe command contains Invoke-WebRequest, iwr, wget, curl",Security Event 4688,Download Cradle: Fetches remote payloads using aliases. Event 4688 captures full arguments (Requires 'Include command line in process creation events' GPO enabled).,"EventCode=4688 NewProcessName=""*\\powershell.exe"" (CommandLine=""*Invoke-WebRequest*"" OR CommandLine=""*iwr*"" OR CommandLine=""*wget*"" OR CommandLine=""*curl*"")",,,DevOps scripts; Chocolatey installer.
Windows,Command and Control, T1105 - Ingress Tool Transfer,PowerShell (Invoke-WebRequest),"powershell.exe command contains Invoke-WebRequest, iwr, wget, curl",PowerShell Event 4104,Download Cradle: Fetches remote payloads using aliases. Powershell 4104 captures full script block,"EventCode=""4104"" ScriptBlockText IN (""*Invoke-WebRequest*"", ""*iwr*"", *""wget*"", ""*curl*"")",,,DevOps scripts; Chocolatey installer.
Windows,Command and Control, T1105 - Ingress Tool Transfer,curl.exe (Native Binary),"Image is curl.exe; Args: -O, -o",Sysmon Event 1,Native Binary Abuse: Distinct from PowerShell alias. Used to bypass PS logging constraints,"EventCode=""1"" Image=""*\\curl.exe"" AND CommadnLine=""*http*"" AND CommandLine IN (""*-O*"" OR ""-o"")",,,DevOps scripts; Developer workstations.
Windows,Command and Control, T1105 - Ingress Tool Transfer,curl.exe (Native Binary),"Image is curl.exe; Args: -O, -o",Security Event 4688,Native Binary Abuse: Distinct from PowerShell alias. Used to bypass PS logging constraints,"EventCode=4688 NewProcessName=""*\\curl.exe"" CommandLine=""*http*"" (CommandLine=""*-O*"" OR CommandLine=""*-o*"")",,,DevOps scripts; Developer workstations.
Windows,Credential Access,T1003.001 _ LSASS Dump,Mimikatz,"Dump files (e.g., lsass.dmp, debug.bin) typically found in %TEMP% or C:\Windows\Temp; Windows Error Reporting (WER) logs (if LSASS crashed during dump); Sysmon Event 11 (File Create) targeting .dmp extension.","Sysmon Event 1
Sysmon Event 10",Detect any unauthorized process attempting to read LSASS memory or if the command line contains sekurlsa.,"(EventCode=""10"" TargetImage=""*lsass.exe"" GrantedAccess=""0x1F3FFF"" SourceImage!=""*svchost.exe"") OR (EventCode=""1"" CommandLine=""*sekurlsa*"")",,,"Antivirus / EDR processes (scanning LSASS memory), Debugging tools (Visual Studio)"
Windows,Credential Access,T1558.003 - Kerberoasting,Rubeus / Impacket,RC4 Ticket Downgrade + Volume Anomaly,Security Event 4769,"High Fidelity: Detects an IP forcing RC4 encryption AND requesting multiple unique SPNs, filtered for non-machine accounts.","EventCode=4769 TicketEncryptionType=0x17 ServiceName!=""*$"" | stats dc(ServiceName) as svc_count by src_ip | where svc_count > 3",,,None (Eliminates single legacy service noise).
Windows,Credential Access,T1558.004 - AS-REP Roasting,Rubeus / Impacket,Pre-Auth Disabled (Type 0) + RC4 Downgrade,Security Event 4768,"High Fidelity: Detects TGT request for accounts with pre-auth disabled, specifically requesting weak RC4 encryption.",EventCode=4768 PreAuthType=0 TicketEncryptionType=0x17,,,Legitimate legacy applications or misconfigured service accounts.
Windows,Credential Access,T1003.006 - DCSync,Mimikatz,Network traffic using DRSUAPI protocol (RPC/TCP 135 & high ports) originating from a non-DC IP; No physical file artifacts typically created on the DC (Memory resident attack).,Sysmon Event 1,Keyword Match: Detects usage of the lsadump::dcsync module.,"EventCode=""1"" CommandLine=""*lsadump::dcsync*""",,,"Azure AD Connect, Backup Solutions"
Windows,Credential Access,T1003.006 - DCSync,Mimikatz,Network traffic using DRSUAPI protocol (RPC/TCP 136 & high ports) originating from a non-DC IP; No physical file artifacts typically created on the DC (Memory resident attack).,Security Event 4662,Detects non-machine accounts requesting 'DS-Replication-Get-Changes' or 'Replication-Get-Changes-All' extended rights on the Domain object. This indicates a DCSync attack simulating a Domain Controller.,"EventCode=4662 ObjectServer=""DS"" AccessMask=""0x100"" Properties IN (""*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2*"", """"*1131f6ab-9c07-11d1-f79f-00c04fc2dcd2*"""") SubjectUserName!=""*$*""",,,"Azure AD Connect, Backup Solutions"
Windows,Credential Access,T1558.001 - Golden Ticket,Mimikatz,Forged Kerberos Ticket files (.kirbi) on disk with 10-year lifetime (if exported); DC Security Log Event 4769 showing encryption downgrade (RC4/0x17) & default flags (0x40810000).,Sysmon Event 1,"Keyword Match: Detects usage of kerberos::golden module, especially with NTLM hash or PTT flag.","EventCode=""1"" CommandLine=""*kerberos::golden*"" AND (CommandLine=""*/krbtgt:*"" OR CommandLine=""*/ptt*"")",,,Red Teaming / Penetration Testing
Windows,Credential Access,T1558.001 - Golden Ticket,Mimikatz,Forged Kerberos Ticket files (.kirbi) on disk with 10-year lifetime (if exported); DC Security Log Event 4769 showing encryption downgrade (RC4/0x17) & default flags (0x40810001).,Security Event 4769,"Encryption Downgrade: Detects Kerberos TGS requests using legacy RC4 encryption (0x17) combined with Mimikatz default ticket options (0x40810000), indicating a forged ticket signed with an NTLM hash.","EventCode=""4769"" TicketOptions=""0x40810000"" TicketEncryptionType=""0x17""",,,Red Teaming / Penetration Testing
Windows,Credential Access,T1552.006 - Group Policy Preferences,PowerSploit/Manual,Groups.xml in SYSVOL,Security Event 4663,Monitor non-admin access to sensitive XML paths in SYSVOL.,"EventCode=""4663"" ObjectName=""*\\SYSVOL\\*\\Policies\\*\\Preferences\\*.xml"" NOT (SubjectUserName=""SYSTEM"" OR SubjectUserName=""*$"")",,,Vulnerability scanners; Backup agents; Administrative scripts auditing GPO configurations.
Windows,Privilege Escalation,T1134.002.- Create Process with Token,runas.exe,Event 4648 (Explicit Credential Logon); Parent Process is Office/Browser/IIS; New console window spawned.,Sysmon Event 1,"Parent Process Anomaly: Detects runas.exe spawned by suspicious parents (Word, Excel, Chrome, w3wp, tomcat). Normal admins launch it from Explorer/CMD.","EventCode=""1"" Image=""*\\runas.exe"" ParentImage IN (""*\\winword.exe"", ""\\excel.exe"", ""*\\chrome.exe"", ""*\\w3wp.exe"")",,,None. (Office/Web Servers should strictly NOT spawn runas.exe)
Windows,Privilege Escalation,T1134 - Access Token Manipulation,Access Token / SACL Monitoring,High-Risk Privilege Enabling (Multi-Vector),Security Event 4703,"etects enabling of any 'God-mode' privileges (Debug, Backup, Restore, TakeOwnership, Tcb, LoadDriver).","EventCode=4703 EnabledPrivileges IN (""*SeDebug*"", ""*SeBackup*"", ""*SeRestore*"", ""*SeTakeOwnership*"", ""*SeTcb*"", ""*SeLoadDriver*"")",,,Admin backup tools; specialized system utilities.
Windows,Lateral Movement,T1550.002 - Pass the Hash,Mimikatz,,Sysmon Event 1,Keyword Match: Detects usage of sekurlsa::pth module to inject NTLM hash.,"EventCode=""1"" CommandLine=""*sekurlsa::pth*"" AND (CommandLine=""*/ntlm:*"" OR CommandLine=""*/rc4:*"")",,,Red Teaming / Penetration Testing
Windows,Lateral Movement,T1550.002 - Pass the Hash,Mimikatz,"Source Host: Event 4624 Type 9 (NewCredentials) with ""SeTcbPrivilege"" use; Target Host: Event 4624 Type 3 (NTLM); Lsass.exe access.",Security Event 4624,"Detects the creation of a logon session with 'NewCredentials' (Type 9), commonly used by PtH tools to use alternate NTLM credentials for network resources.","EventCode=""4624"" LogonType=""9"" AuthenticationPackage=""Negotiate"" LogonProcessName=""seclogon""",,,"Legitimate use of 'runas /netonly' by system administrators; SQL Server Management Studio (ssms.exe) authenticating to remote DBs; Developer tools (Visual Studio, Git) accessing network repos; Scheduled tasks accessing network shares."
Windows,Lateral Movement,T1550.003 - Pass the Ticket,Mimikatz,Presence of .kirbi or .ccache files in user profile or %TEMP%; 'klist' command output showing tickets belonging to other users; Event 4624 (Type 9 - NewCredentials) logs.,Sysmon Event 1,"Command Line Keyword: Detecting the command to import a ticket file. The standard command of Mimikatz for the type of attack is kerberos::ptt <ticket_file>, and .kirbi if the default extension of Kerberos ticket file in Windows","EventCode=""1"" (CommandLine=""*ptt*"" OR CommandLine=""*.kirbi*"")",,,Red Teaming / Penetration Testing
Windows,Lateral Movement,T1021.002 - Remote Services: SMB/Windows Admin Shares,"net.exe, PowerShell",New network share creation; Share Name (hidden vs public); Share Path pointing to system roots.,Security Event 5142,"Sensitive Path Abuse: Detects the creation of network shares pointing to OS-critical or data-rich paths (e.g., System32, Users).","EventCode=""5142"" SharePath IN (""C:\\"", ""C:\\Windows*"", ""C:\\Users*"", ""C:\\ProgramData*"", ""C:\\Temp*"")",,,
Windows,Lateral Movement,T1021.002 - SMB/Admin Shares,"PsExec, Impacket-psexec","PSEXESVC.exe (in %SystemRoot%), \psexesvc Named Pipes, Service ImagePath Registry Key","Sysmon 11, 13, 17, 18",The PsExec Triad: Correlates the orchestration of remote execution. 1. System process (PID 4) drops binary (Event 11); 2. SCM registers service (Event 13); 3. System creates Named Pipes (Event 17/18). Tracks the mechanism over the filename.,"(EventCode=13 Image=""*\\services.exe"" TargetObject=""*\\ImagePath"") OR (EventCode=11 Image=""System"" TargetFilename=""C:\\Windows\\*.exe"") OR (EventCode=18 Image=""System"" PipeName=""\\psexesvc*"")",,,Authorized IT remote troubleshooting; SCCM/MECM software distribution; Third-party system management agents.
Windows,Defense Evation,T1562.002 - Impair Defenses: Disable Windows Event Logging,auditpol.exe,SACL modification (Stripping),Security Event 4907,"Detect removal of Success/Failure audit ACEs in SDDL S:(AU;) string on sensitive objects (SAM, NTDS, LSASS). Indicators include SubjectUserName != 'SYSTEM' or unusual Admin account.","EventCode=4907 AND (ObjectName=""*\\lsass.exe"" OR ObjectName=""*\\ntds.dit"" OR ObjectName=""*\\config\\SAM"")",,,Authorized security software or GPO updates to auditing policies.
Windows,Defense Evation,T1218.011 - Rundll32 Proxy Execution,rundll32.exe,Rundll32 loading DLL via Ordinal,Sysmon Event 1,"Detects rundll32 using ordinals (e.g., #1) to hide intent.","EventCode=1 Image=""*\\rundll32.exe"" CommandLine=""*,#*""",,,Rare legacy apps.
Windows,Defense Evation,T1574.001 - Hijack Execution Flow: DLL,Generic Signed Binaries,"Unsigned DLL in System Binary context,",Sysmon Event 7,Detects signed binaries loading unsigned DLLs outside of protected system directories.,"EventCode=7 Signed=false NOT (ImageLoaded=""*\\Windows\\*"" OR ImageLoaded=""*\\Program Files*"")",,,Third-party apps installed in custom root folders (e.g. C:\Python39)
Windows,Defense Evation,T1036 - Masquerading,DLL Metadata Analysis,OriginalFileName Mismatch,Sysmon Event 7,Detects DLLs where OriginalFileName does not match disk filename.,EventCode=7 | where OriginalFileName != FileName,,,Legitimate updates renaming old DLLs.
Windows,Defense Evation,T1055 - Process Injection,Memory Injection (General),"CallTrace contains ""Unknown""",Sysmon Event 10,Detects process access originating from memory regions not associated with a file on disk. Tier 1 (High Recall): Monitor all 'Unknown' traces. Tier 2 (High Precision): Focus on TargetImage=lsass.exe to detect credential dumping.,"EventCode=10 CallTrace=""*Unknown*"" NOT (SourceImage=""*\\Windows\\Microsoft.NET\\*"" OR SourceImage=""*\\chrome.exe"")",,,"JIT compilation (.NET, Java), Browsers, EDR agents, and anti-cheat software."
Windows,"Execution, Defense Evasion","T1059.001 - PowerShell, T1218 - System Binary Proxy Execution",Unmanaged PowerShell (via Native Binaries),"clr.dll (Primary),System.Management.Automation.dll, System.Management.Automation.ni.dll",Sysmon Event 7,"Tier 1 (High Recall): Detect native binaries (calc, notepad, etc.) loading clr.dll to identify .NET runtime hijacking. Tier 2 (High Precision): Detect the same binaries loading System.Management.Automation.dll for direct PowerShell engine usage.","EventCode=7 (ImageLoaded=""*\\clr.dll"" OR ImageLoaded=""*\\System.Management.Automation*"") NOT (Image=""*\\powershell.exe"" OR Image=""*\\pwsh.exe"" OR Image=""*\\Windows\\Microsoft.NET\\*"")",,,"Heavy Noise: .NET-based enterprise agents, Visual Studio, and SQL Server. Solution: Baseline your environment and exclude known-safe .NET directory paths."