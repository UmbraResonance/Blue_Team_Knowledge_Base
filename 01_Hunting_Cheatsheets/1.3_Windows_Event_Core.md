# 1.3 Windows Event Core Deep-Dive

> [!TIP]
> **Priority Strategy:** Focus on P0 (Execution/Auth) for daily hunting. Use Category 0 (Integrity) to verify your visibility.

## Category 0: Defense Integrity

*Purpose: Ensuring the "Security Cameras" are not tampered with.*

### Event 4907: Object Audit Policy Changed
* **Priority:** High Impact / Low Frequency (Defense Evasion)
* **Adversary Intent:** Defense Evasion (TA0005). Specifically targeting Impair Defenses: Disable Windows Event Logging (T1562.002). Advanced actors modify SACLs to "silence" audit logs before accessing sensitive objects (e.g., lsass.exe, NTDS.dit, or Registry Keys).
* **Key Fields to Analyze:**
    - SubjectUserName: Who performed the change? (Suspicious if not a known Admin/System account).
    - Object Name: Which sensitive path was silenced?
    - Security Descriptor (SDDL): The core string describing the audit change.
* **SDDL Analysis Tip (SACL Focus):**
    - Specifically monitor for the removal of SA (Success) or FA (Failure) flags in the S:(AU;...) string.
    - Example: If (AU;SAFA;...;WD) is changed, the attacker has disabled auditing for "Everyone" (WD).
* **Reference:** [8.1.1_Object_Security_SACL](../08_Underlying_Principles/8.1_WIndows_Internals/8.1.1_Object_Security_SACL.md) (Mechanism of SACL modification)

---

## Category 1: Execution & Lineage (P0)

*Purpose: Catching the act of execution.*

### Event 4688: New Process Created

* **Priority:** Critical Impact / High Frequency
* **Adversary Intent:** Cross-Tactic Execution Carrier. Primarily associated with Execution (TA0002), but serves as the visibility engine for Persistence, Privilege Escalation, and Credential Access.
* **Key Fields to Analyze:**
    - NewProcessName: Full path of the executable. Check for random strings or non-standard directories.
    - ParentProcessName: Critical for lineage. Verify against [1.2_Windows_Process_Genealogy](./1.2_Windows_Process_Genealogy.csv).
    - CommandLine: The primary source for identifying download cradles and obfuscation (e.g., Base64).
    - SubjectLogonId: Useful for correlating the process back to a specific login session (Event 4624).
* **Detection Logic (General Principles):**
    * **Lineage Check:** Flag illegal parents.
    * **Command Line Audit:** Analyze the `CommandLine` field for obfuscation (Base64), download cradles, or LoLBin abuse.
    * **Path Anomaly:** Monitor executions from writable directories (`\Temp`, `\Public`, `\PerfLogs`).
* **Reference:** For specific threat mappings (e.g., Mimikatz, Certutil), see [1.1_Master_Hunting_Matrix](./1.2_Windows_Process_Genealogy.csv).

---

## Category 2: Authentication

*Purpose: Identifying Lateral Movement.*


---

## Appendix: Detection Priority Matrix

*Purpose: To standardize the classification of Event IDs based on their operational impact and observation frequency during an investigation.*

### 1. Classification Framework

| Priority Level | Impact (Severity) | Frequency (Visibility) | Description & Logic |
| :--- | :--- | :--- | :--- |
| **P0: Critical** | **High** | **High** | **Core Detection Pipeline.** Events that record the primary actions of an adversary (Execution, Auth). Mandatory for baseline monitoring. |
| **P1: Warning** | **High** | **Low** | **Defense Evasion / Integrity.** Events indicating tampering with security controls or auditing policy changes (e.g., Event 4907). |
| **P2: Informational** | **Medium** | **Varies** | **Forensic Support.** Supplemental logs used for deep-dive root cause analysis and reconstructing specific object access history. |

### 2. Priority Determination Workflow

To maintain consistency when adding new Event IDs, evaluate them against these three criteria:

1.  **Choke Point Analysis:** Is this event part of an adversary's mandatory path (e.g., Process Start)? 
    * *Yes* -> **High Impact**.
2.  **Noise Floor Evaluation:** Does this event generate millions of logs daily under normal conditions (e.g., File Read)? 
    * *Yes* -> **Medium/High Frequency**.
3.  **Adversarial Focus:** Is this event typically generated when an attacker tries to hide their tracks? 
    * *Yes* -> **P1: Warning (Low Frequency)**.
