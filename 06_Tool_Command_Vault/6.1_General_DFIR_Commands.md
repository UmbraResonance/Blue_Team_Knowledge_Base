# 6.6 General DFIR & Utility Command Reference

> **Focus:** Essential, quick-access commands for evidence handling, integrity checking, and basic data manipulation.
> **Use Case:** When you need to calculate a hash, unzip a file, or grep a string *now*.
> **Legend:** Replace values inside `<...>` with your actual paths.

---

## File Hashing (Integrity & IoC Check)

*Always hash evidence immediately after acquisition!*

### Windows

**PowerShell (Recommended):**
```powershell
# Calculate SHA256 (Default)
Get-FileHash -Path "<PATH_TO_MALICIOUS_FILE>"

# Calculate MD5 (Legacy IoC match)
Get-FileHash -Path "<PATH_TO_MALICIOUS_FILE>" -Algorithm SHA256
```

**CMD (Native):**
```cmd
certutil -hashfile "<PATH_TO_MALICIOUS_FILE>" SHA256
```

### Linux

```bash
sha256sum <PATH_TO_MALICIOUS_FILE>
sha256sum * > hash_list.txt
```

## File Identification (Magic Bytes)

*Don't trust file extensions. Malware often hides as .txt or .jpg.*

### Windows

**PowerShell (Recommended):**
```powershell
# Read first 4 bytes (Magic Number)
Get-Content "<PATH_TO_SUSPICIOUS_FILE>" -Encoding Byte -TotalCount 4
```

**CMD (Native):**
```cmd
certutil -encodehex "C:\Evidence\suspicious.jpg" <TAGRET_FILE.hex> 11 && type <TAGRET_FILE.hex> | findstr "0000"
```

### Linux 

```bash
file <FILENAME>
```

## String Searching (Basic Hunting)

### Windows

**findstr - text files only**
```cmd
# Case-insensitive recursive search
findstr /S /I "password" *.txt
```

**Sysinternals**
*Note: Native Windows `findstr` is weak for binaries. Use Sysinternals strings.exe if available.*
```cmd
strings.exe -n 10 "C:\Evidence\malware.exe"
```

### Linux

```bash
# Extract readable strings (min length 10)
strings -n 10 <FILENAME> > output.txt

# Grep recursively (Find "password" in all files in current dir)
grep -r "password" .
```

## Archiving & Evidence Preservation

### Windows

**PowerShell (Recommended):**
```powershell
# Compress (No password support natively in older PS, use 7-Zip if installed)
Compress-Archive -Path "<FILE_PATH>" -DestinationPath "<DESTINATION_PATH>"
```

### Linux
```bash
# Create password-protected zip (Standard password: "infected")
zip --password <PASSWORD> <DESTINATION_PATH> <FILE_PATH>
```

## Base64 Decoding (CLI)

### Windows

```cmd
# 1. Save string to file
echo <BASE64_ENCODED_STRING> > <TARGET_FILE_ENCODED.txt>

# 2. Decode
certutil -decode <TARGET_FILE_ENCODED.txt> <TARGET_FILE_DECODED.txt>

# 3. Read
type <TARGET_FILE_DECODED.txt>
```

### Linux

```bash
echo "<BASE64_ENCODED_STRING>" | base64 -d
```
