# 6.5 Memory Forensics (Volatility 3)

> **Focus:** Rapid extraction of artifacts from RAM dumps.
> **Engine:** Volatility 3 (`vol.py`).
> **Note:** Replace `<IMAGE>` with your memory file path.
> **Tip:** Always redirect output to a file (`> output.txt`) for grepping later.

---

## Triage & Identification (Start Here)

### Step 1: Identify the Image

*Verify the image is readable and identify the OS profile.*

```bash
python3 vol.py -f "<IMAGE>" windows.info
```

### Step 2: Rogue Process Hunting

*Quickly spot anomalies in the process list.*

**A. Process Tree (Parent/Child Relationshi)**: Looking for suspicious parent/child relationships.
```bash
python3 vol.py -f "<IMAGE>" windows.pstree > pstree.txt
```

**B. Command Lines**: Looking for Base64 encoded PowerShell or temp paths.
```bash
python3 vol.py -f "<IMAGE>" windows.cmdline > cmdline.txt
```

**C. Hidden Processes (PsScan)**: Compare pslist vs psscan. If a PID is in scan but not list, it might indicate a Rootkit/DKOM.
```bash
python3 vol.py -f "<IMAGE>" windows.psscan > psscan.txt
```

## Network & Connections (C2 Hunting)

*Link an IP address to a Process ID (PID).*

```bash
python3 vol.py -f "<IMAGE>" windows.netscan > netscan.txt
```
- Hunting Tip: Grep for "ESTABLISHED" or specific ports (443, 8080).

```bash
grep "ESTABLISHED" netscan.txt
```

## Malware Extraction

### Code Injection Hunting (Malfind)

*Find processes with executable memory permissions (RWX) but no file on disk.*

```bash
python3 vol.py -f "<IMAGE>" windows.malfind > malfind.txt
```

### Dump a Suspicious Process (Binary Extraction)

*Extract the executable (.exe) from memory to disk for further check.*

```bash
# Dump the executable of a specific PID
python3 vol.py -f "<IMAGE>" windows.dumpfiles --pid <PID>
```

### Dump Process Memory

*Dump the full memory space of a process (good for finding passwords/configs).*

```bash
# Dump memory map of a PID
python3 vol.py -f "<IMAGE>" windows.memmap --dump --pid <PID>
```

## Specific Artifacts (Quick Wins)

### Passwords (Hashdump)

*Extract NTLM hashes.*

```bash
python3 vol.py -f "<IMAGE>" windows.hashdump
```

### File Scanning (Find Deleted Files)

*Find a file path in memory even if deleted from disk.*

```bash
python3 vol.py -f "<IMAGE>" windows.filescan | grep "<MALWARE_NAME>"
```