# 6.1 Digital Forensics Tools (Zimmerman & KAPE)

> **Focus:** Parsing Windows Artifacts efficiently.
> **Note:** Always use PowerShell/CMD as Admin.

## Eric Zimmerman Tools (EZ Tools)

### Prefetch (PECmd)

*Evidence: Prove execution & verify execution time.*

**Parse a single file (Target specific malware):**
```powershell
PECmd.exe -f "PATH_TO_MALICIOUS_FILE.pf>â€œ
# Default Prefetch files are under C:\Windows\Prefetch in living system.
```

**Parse WHOLE directory to CSV (The Standard Move):**
```powershell
# Parse WHOLE directory to CSV (The BTL1 Standard Move)
PECmd.exe -d "<DIRECTORY_WITH_PREFETCH_FILES>" -csv "C:\Temp\Output" -q
# Default Prefetch files are under C:\Windows\Prefetch in living system.
```

- Key Output: RunCount, LastRun (UTC), ExecutablePath.

### MFT (MFTECmd)

*Evidence: File creation, deletion, and timestomping checks.*

**Parse $MFT to CSV:**
```powershell
MFTECmd.exe -f "<PATH_TO_$MFT_FILE>" -csv "<OUTPUT_DIRECTORY>" --csvf <OUTPUT_FILENAME.csv>

# Default MFT file path is C:\$MFT
```

- Tip: Filter output CSV for .exe, .ps1, or Zone.Identifier (ADS).

### JumpLists (JLECmd)

*Evidence: Application-specific recent file access history. (e.g., Which Word docs were opened?)*

**Parse AutomaticDestinations/CustomDestinations to CSV:**
```powershell
JLECmd.exe -d "<PATH_TO_USER_AUTOMATICDESTINATIONS>" --csv "<OUTPUT_DIRECTORY>" -q
# Path: 
# 1. C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations
# 2. C:\Users\<User>\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations
```

### LNK Files (LECmd)

*Evidence: File execution, original path, and MAC times. (Use this to prove a file existed on a specific drive/path)*

**Parse LNK Files in Recent Folder to CSV:**
```powershell
LECmd.exe -d "<PATH_TO_USER_RECENT>" --csv "<OUTPUT_DIRECTORY>" -q
# Path: C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Recent
```

### ShellBags (SBECmd)

*Evidence: Folder Browsing history. (Proof that the user navigated into specific folders, e.g., C:\Confidential)*

**Parse UsrClass.dat (Standard User) to CSV:**
```powershell
SBECmd.exe -d "<DIRECTORY_WITH_USRCLASS.DAT>" --csv "<OUTPUT_DIRECTORY>" -q
# Path: C:\Users\<USERNAME>\AppData\Local\Microsoft\Windows\UsrClass.dat
```

### ShimCache (AppCompatCacheParser)

**Evidence: Execution history, even if file is deleted.**

**Parse SYSTEM hive to CSV:**
```powershell
AppCompatCacheParser.exe --csv "<OUTPUT_DIRECTORY>" -f "<PATH_TO_SYSTEM_HIVE>"
# Example: AppCompatCacheParser.exe --csv "C:\Temp" -f "C:\Windows\System32\config\SYSTEM"
```

### Amcache (AmcacheParser)

**Evidence: SHA1 hashes of executed binaries.**

**Parse Amcache.hve: to CSV**
```powershell
AmcacheParser.exe --csv "<OUTPUT_DIRECTORY>" -f "<PATH_TO_AMCACHE_HIVE>" -i on
# Example: AmcacheParser.exe --csv "C:\Temp" -f "C:\Windows\appcompat\Programs\Amcache.hve" -i on
```

- Flag Note: `-i on` includes unassociated file entries (Important for loose binaries).