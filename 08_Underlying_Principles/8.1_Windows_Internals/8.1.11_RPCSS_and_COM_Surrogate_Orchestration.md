# 8.1.12 RPCSS & COM Surrogate Orchestration

> **Core Principle**: COM is not just a registry entry; it is an active orchestration system managed by the RPCSS service. Understanding the "Foreman" is key to detecting COM-based persistence.

## 1. RPCSS: The COM Foreman
The **Remote Procedure Call Service (RPCSS)** is responsible for:
* **Activation**: Finding the CLSID in the registry and deciding how to run it.
* **Resolution**: Prioritizing `HKCU` entries over `HKLM` (the root of COM hijacking).
* **Management**: Starting the surrogate processes.

## 2. Surrogate Processes (`dllhost.exe`)
When a COM object is designed to run outside the caller's process for stability or security, it is hosted in `dllhost.exe`.
* **Standard Behavior**: `dllhost.exe` is launched by `svchost.exe -k DcomLaunch`.
* **The Attack**: If a hijacked CLSID is triggered, `dllhost.exe` will load the malicious DLL.

## 3. Detection & Hunting
* **Parent-Child Anomaly**: `dllhost.exe` should almost always be a child of the DCOM Launch service host. Any other parent is highly suspicious.
* **Command Line Analysis**: Monitor the `/Processid:{GUID}` flag in the `dllhost.exe` command line. Cross-reference this GUID with the registry to identify which COM object is being activated.
* **Inherited Context**: Look for `dllhost.exe` inheriting the token and network permissions of the user who triggered the COM object, potentially allowing for silent data exfiltration.