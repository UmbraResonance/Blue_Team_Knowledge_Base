# Kernel Guardrails: The Final Audit (SSDT & Probing)

> **Core Principle**: The Kernel does not "blindly execute" Syscalls. It is the final gatekeeper that validates every request before physical execution.

## 1. SSDT Validation (The Service Menu)
When a Syscall enters the Kernel, it uses the **SSDT (System Service Descriptor Table)** to map the ID to a function. If the ID is invalid or points to an unauthorized service, the Kernel rejects the request immediately.

## 2. Memory Probing (The Safety Barrier)
The Kernel never trusts user-provided memory pointers.
* **Probing**: It uses `ProbeForRead` and `ProbeForWrite` to ensure the application isn't tricking the Kernel into modifying **Kernel Space** memory.
* **Capturing**: Parameters are copied (Captured) from User Space into a Kernel-owned buffer to prevent **Time-of-Check to Time-of-Use (TOCTOU)** attacks.

## 3. Final Access Check (Token vs. ACL)
This is the ultimate hurdle for any adversary.
1. **The Subject**: The Kernel identifies the process's **Access Token**.
2. **The Object**: The Kernel identifies the target's **SACL/DACL**.
3. **The Decision**: If the SID/Privileges in the token do not match the ACL's requirements, the Kernel returns `STATUS_ACCESS_DENIED` (0xC0000022).

## 4. Analytical Mindset
* **Adversaries bypass Observers (EDR)**, but they cannot bypass **Physical Laws (Kernel)**.
* Detection should focus on the "Artifact of Success"â€”even if the call was hidden via Direct Syscall, the resulting handle or modified file remains a detectable state change.