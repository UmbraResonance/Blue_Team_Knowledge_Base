# Security Context: Tokens, Handles, and Pointers

> **Core Principle**: The Kernel is the "Central Bank" of assets. Accessing any restricted asset (files, processes) requires a valid "Voucher" (Handle).

## 1. Access Token (The Identity)
* **Nature**: A kernel object representing a subject's identity (SID) and privileges.
* **Impersonation**: Malware often attempts to steal tokens from high-privilege processes to escalate privileges without changing the user account.

## 2. Handle (The Voucher) vs. Pointer (The Address)

| Dimension | **Handle** | **Pointer** |
| :--- | :--- | :--- |
| **Abstract** | An index in the Kernel's "Voucher Table". | A direct physical/virtual address in memory. |
| **Auditing** | **Kernel-enforced**. Every use is audited. | **Direct Access**. No kernel audit during use. |
| **Risk** | Can be revoked or tracked by the OS. | Used for "In-memory" only evasion (e.g., VTable). |

## 3. Handle Auditing for Hunting
* **Handle Stealing**: Monitor for processes requesting `PROCESS_ALL_ACCESS` to sensitive processes like `lsass.exe`.
* **Ground Truth**: While EDR may miss the API call, the **Handle Table** in the kernel remains the source of truth for what a process currently "holds."