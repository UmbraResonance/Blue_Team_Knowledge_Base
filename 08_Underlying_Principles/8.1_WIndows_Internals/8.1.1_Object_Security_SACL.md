# Object Security & SACL (System Access Control List)

> **Core Concept:** While DACLs (Discretionary Access Control Lists) determine **Access**, SACLs determine **Visibility** and **Auditing**.
> **Blue Team Impact:** SACL manipulation is a high-fidelity indicator for **Defense Evasion (T1562.002)**.

---

## 1. Technical Architecture

In the Windows Security Model, every securable object (File, Registry, Process, etc.) contains a **Security Descriptor**. The SACL is the specific component within this descriptor that instructs the Local Security Authority (LSA) to generate an audit record in the Security Log.

### **The Audit Check Workflow**
1.  **Subject Initiation:** A user or process (Subject) attempts an action (e.g., Read/Write) on an Object.
2.  **Access Token Evaluation:** The Windows Kernel compares the Subject's **Access Token** against the Object's **SACL** entries (ACEs).
3.  **Event Generation:** * If the action matches a SACL entry (Success/Failure), **Event ID 4663** is generated.
    * If the SACL itself is modified, **Event ID 4907** is generated.

---

## 2. SDDL Syntax (SACL Focus)

When analyzing **Event 4907**, the modification is recorded in **Security Descriptor Definition Language (SDDL)** format.

**SACL Component Structure:** `S:(AU;[Flags];[Mask];;;[SID])`

| Component | Code | Description | Blue Team Significance |
| :--- | :--- | :--- | :--- |
| **Audit Type** | `AU` | Audit | Standard audit entry indicator. |
| **Audit Flags** | `SA` | Success | Logs successful attempts. |
| **Audit Flags** | `FA` | Failure | Logs failed attempts (Key for brute force/recon detection). |
| **Permissions** | `FA` | File All | Monitor for "Full Control" changes on sensitive files. |
| **Permissions** | `RY` | Read Property | Monitor for reading sensitive attributes/metadata. |
| **Trustee SID** | `WD` | Everyone | Audits actions from ALL users. |
| **Trustee SID** | `SY` | Local System | Audits actions performed by the system account. |

---

## 3. Adversary TTPs

### **Scenario A: Blind Spot Creation (T1562.002)**
* **Mechanism:** Adversaries use `auditpol.exe`, PowerShell, or direct API calls to remove specific ACEs from an object's SACL.
* **Target:** High-value targets like `C:\Windows\System32\config\SAM` or the `lsass.exe` process.
* **Goal:** To execute Credential Dumping without triggering "Object Access" (Event 4663) alerts.

### **Scenario B: Global Audit Policy Overwrite**
* **Mechanism:** Overwriting system-wide audit policies to disable the "Object Access" category entirely.
* **Detection:** This typically generates **Event ID 4719** (System Audit Policy Changed) rather than 4907.

---

## 4. Detection Engineering (SOC Red Flags)

| Red Flag | Description | Correlation |
| :--- | :--- | :--- |
| **Unauthorized Subject** | Modification of a SACL by a non-admin/non-system user. | Cross-reference with [[1.3_Windows_Event_Core#Event_4907]]. |
| **SACL Stripping** | A new SDDL string that is significantly shorter or missing `SA`/`FA` flags. | Check T1562.002 in [[1.1_Master_Hunting_Matrix]]. |
| **LoLBin Execution** | Execution of `auditpol.exe` or `wevtutil.exe` preceding a 4907 event. | Check [[1.2_Windows_Process_Genealogy]] for parentage. |

---

## Related References
- [1.3_Windows_Event_Core](../../01_Hunting_Cheatsheets/1.3_Windows_Event_Core.md): Log field analysis for Event 4907 and 4663.
- [1.1_Master_Hunting_Matrix](../../01_Hunting_Cheatsheets/1.1_Master_Hunting_Matrix.csv): MITRE TTP mappings for Defense Evasion.
- [[8.1.2_Access_Tokens]]: Understanding the "Subject" side of the security check.