# Schema and Object Templates

## Overview
The Schema is the "Blueprint" or "DNA" of the Active Directory forest. It dictates the structural rules for the entire database, defining what can exist and what characteristics it must possess.

## Underlying Principles
### The Philosophy of "Everything is a Template"
Microsoft uses a metadata-driven approach where every object is an "instance" of a predefined "class."
- **Class:** Defines the object type (e.g., `user`, `computer`, `group`).
- **Attributes:** Characteristics of the class (e.g., `displayName`, `pwdLastSet`).
- **Instantiation:** The process of creating a real object (Instance) from a Class template.

## Internal Mechanisms
### 1. Object Identifiers (OIDs)
Every Class and Attribute in the schema has a unique, dot-separated OID (e.g., `2.5.4.4` for `sn`). This ensures global LDAP standardization and prevents naming collisions.

### 2. dsHeuristics (The Global Toggle)
A forest-wide configuration string stored in the Configuration Partition. 
- **Logic:** Specific bits control fundamental AD behaviors. For example, the 9th bit toggles "List Object Mode" (providing object-level stealth), and the 10th bit governs the exclusion logic for Protected Groups.

## Security and Hunting Implications
- **Schema Mining:** By auditing the Schema partition, analysts can identify non-standard attribute extensions. Attackers may utilize custom attributes to hide data or establish covert communication channels.
- **Attribute Naming Convention:** AD attributes primarily use **lowerCamelCase** (e.g., `msDS-AllowedToDelegateTo`), a standard influenced by early Microsoft developer practices (VB/C#), which helps in identifying legitimate vs. suspicious custom attributes.