# Governance and Protection Mechanisms

## Overview
AD utilizes a distributed governance model to handle conflicts and an automated "Self-Healing" immune system to protect high-privileged accounts from accidental or malicious modification.

## Underlying Principles
### Distributed Single-Master Philosophy (FSMO)
To prevent synchronization conflicts in a distributed environment, specific tasks are assigned to a single master DC. These are the **Flexible Single Master Operation (FSMO)** roles:
- **Forest-wide:** Schema Master (DNA control) and Domain Naming Master (Boundary control).
- **Domain-wide:** RID Master (Identity issuance), PDC Emulator (Core orchestration), and Infrastructure Master (Cross-domain translation).

## Internal Mechanisms
### 1. AdminSDHolder and SDProp (The Immune System)
- **AdminSDHolder:** A template object in the System container. It holds the authoritative ACL for privileged groups (e.g., Domain Admins).
- **SDProp (Security Descriptor Propagator):** A process running on the **PDC Emulator** every 60 minutes. It scans objects with `adminCount=1`, enforces the AdminSDHolder ACL, and **disables inheritance** to prevent permission "bleeding" from parent OUs.

### 2. Access Control (ACL/ACE)
- **DACL:** Discretionary access control (Who can access).
- **SACL:** System access control (Who is audited).

## Security and Hunting Implications
- **Persistence via AdminSDHolder:** If an attacker modifies the AdminSDHolder template itself, the SDProp process will inadvertently distribute the attacker's backdoor to every privileged account in the domain.
- **adminCount Monitoring:** Identifying users with `adminCount=1` who are no longer in privileged groups is a classic "Digital Archaeology" task to find "Ghost Administrators" or stale high-value targets.

## 3. Container Objects: Groups and Organizational Units (OUs)
While both are containers, their roles in permission flow differ fundamentally.

### Group Nesting and Permission Bleeding
- **Design Philosophy:** Groups are intended to simplify administration, but "Nested Groups" (Group A inside Group B) create hidden permission paths.
- **Internal Logic:** When a user logs in, `lsass.exe` recursively traverses all nested memberships to include all corresponding SIDs in the Access Token.
- **Security Risk:** This often leads to **"Permission Bleeding,"** where users obtain unintended administrative rights through complex nesting chains.
- **Hunting Tooling:** BloodHound is the industry standard for visualizing these unintended "Shortest Paths" to Domain Admin.

### Administrative Delegation (The OU Logic)
- **Logic:** OUs do not have SIDs and cannot be security principals. Their primary security role is as a target for **Administrative Delegation** (e.g., Help Desk OU having reset rights over Users OU) and GPO linking.