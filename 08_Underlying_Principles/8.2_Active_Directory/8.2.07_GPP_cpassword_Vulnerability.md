# GPP (Group Policy Preferences) cpassword Vulnerability

## Overview
Group Policy Preferences (GPP), introduced with Windows Server 2008, allowed administrators to automate tasks such as updating local administrator passwords or creating scheduled tasks. To secure credentials used in these policies, Microsoft encrypted them using AES-256 before storing them in XML files within the `SYSVOL` share. However, the static private key required for decryption was inadvertently published on MSDN, rendering the encryption effectively useless.

## Technical Deep Dive
* **Storage Location**: `\\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\{GUID}\Machine\Preferences\Groups\Groups.xml`
* **Encryption Standard**: AES-256.
* **The Static Key**: 
  `4e 99 06 e8 fc b6 6c c9 fa f4 93 10 62 0f fe e8 f4 96 e8 06 cc 05 79 90 20 9b 09 a4 33 b6 6c 1b`
* **Vulnerability Logic**: Since `SYSVOL` is readable by all 'Authenticated Users' (including computers and low-privileged users), any domain user can locate these XML files and decrypt the `cpassword` attribute using the publicly known key.

## Evidence-Based Facts
1. **Static Key Exposure**: The 32-byte AES key is hardcoded and identical across all Active Directory environments globally.
2. **SYSVOL Accessibility**: By design, the `SYSVOL` folder must be accessible to all domain members to allow GPO application.
3. **MS14-025 Patch**: While this patch prevents the creation of new GPPs containing passwords, it does not remediate or delete pre-existing XML files containing credentials.

## Inference-Based Theories
1. **Legacy Persistence**: This vulnerability is most commonly found in environments that have been upgraded from older functional levels (e.g., Server 2008/2012) where legacy GPOs were never audited or cleaned.
2. **Attacker Priority**: Due to the 100% decryption success rate, this is often one of the first vectors checked by attackers during internal reconnaissance.